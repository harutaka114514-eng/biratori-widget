<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>biratori-widget</title>
<style>
body{font-family:"Segoe UI","Hiragino Sans","Noto Sans JP",sans-serif;background:linear-gradient(rgba(255,255,255,.75),rgba(255,255,255,.75)),url("background.jpg") center/cover no-repeat fixed;padding:15px;color:#333;margin:0;}
h1{margin:5px 0 10px;font-size:20px;font-weight:600;text-align:center;}
.widgets{display:flex;flex-direction:column;gap:15px;max-width:900px;margin:0 auto;}
.widget{background:rgba(255,255,255,.9);padding:15px;border-radius:18px;box-shadow:0 10px 25px rgba(0,0,0,.08);display:flex;flex-direction:column;box-sizing:border-box;}

/* 1æ®µç›®ï¼šæ™‚è¨ˆãƒ»å¤©æ°—ãƒ»ã”ã¿ãƒœã‚¿ãƒ³ */
.top-row{display:grid;grid-template-columns:1fr 200px;gap:12px;align-items:stretch;}
.clock-weather-line{display:flex;justify-content:space-between;align-items:center;}
#clock{font-size:20px;font-weight:700;font-family:monospace;}
.weather-area{display:flex;align-items:center;gap:8px;}
.weather-label{font-size:12px;color:#666;font-weight:bold;background:#eee;padding:2px 6px;border-radius:4px;text-decoration:none;}
.weather{font-size:18px;font-weight:700;}
.garbage-button{background:#fef3c7;border-radius:12px;padding:10px;font-size:13px;border:1px solid #f59e0b;text-align:center;display:flex;flex-direction:column;justify-content:center;cursor:pointer;font-weight:bold;text-decoration:none;color:#92400e;min-height:70px;}
.garbage-button span{font-size:10px;font-weight:normal;margin-top:4px;}

/* 2æ®µç›®ï¼šYouTubeãƒ©ã‚¤ãƒ–ï¼ˆã”æç¤ºã®å‹•ç”»ã‚’åŸ‹ã‚è¾¼ã¿ï¼‰ */
.video-container {position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:12px;background:#000;}
.video-container iframe {position:absolute;top:0;left:0;width:100%;height:100%;border:0;}

/* 3æ®µç›®ï¼šãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ»ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ */
.bottom-row{display:grid;grid-template-columns:1fr 280px;gap:12px;}
.news-tabs{display:flex;gap:6px;margin-bottom:10px;overflow-x:auto;padding-bottom:8px;}
.news-tabs button{padding:6px 14px;font-size:11px;background:#e5e7eb;border:0;border-radius:999px;cursor:pointer;white-space:nowrap;}
.news-tabs button.active{background:#2563eb;color:#fff}
.news-list{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px;}
.news-list li{background:#fff;border-radius:10px;padding:10px;border:1px solid #eee;}
.news-list a{text-decoration:none;color:#1a1a1a;font-size:13px;line-height:1.4;font-weight:600;}

/* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ */
.cal-nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;}
.cal-btn{background:none;border:none;font-size:18px;cursor:pointer;padding:0 10px;color:#2563eb;font-weight:bold;}
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px}
.cal-header{font-size:10px;font-weight:bold;text-align:center;padding-bottom:4px;color:#666;}
.cal-cell{background:#f8fafc;border-radius:5px;padding:4px;min-height:40px;text-align:center;font-size:11px;display:flex;flex-direction:column;justify-content:flex-start;}
.cal-num{font-weight:700;} 
.sun, .holiday-num{color:#ef4444} 
.sat{color:#3b82f6} 
.cal-today{outline:2px solid #2563eb;background:#eff6ff}
.cal-dim{opacity:0.4;}
.holiday-name{font-size:8px;color:#ef4444;margin-top:2px;line-height:1;}

@media(max-width:750px){ .top-row, .bottom-row{grid-template-columns:1fr;} }
</style>
</head>
<body>

<h1>biratori-widget</h1>

<div class="widgets">
  <div class="top-row">
    <div class="widget">
      <div class="clock-weather-line">
        <div id="clock">--:--:--</div>
        <div class="weather-area">
          <a href="https://tenki.jp/forecast/1/2/2110/1601/" target="_blank" class="weather-label">å¹³å–</a>
          <div id="weather" class="weather">--â„ƒ</div>
        </div>
      </div>
    </div>
    <a href="https://biratorieisei-hokkaido.jp/biratorieisei/wp-content/uploads/r7biratori.pdf" target="_blank" class="garbage-button">
      ğŸ—‘ R7å¹´åº¦ã”ã¿åé›†PDF
      <span>ğŸ”¥æœˆæœ¨ / â™»æ°´</span>
    </a>
  </div>

  <div class="widget">
    <div class="video-container">
      <iframe 
        src="https://www.youtube.com/embed/tvgbZZYS4Nk?autoplay=1&mute=1&rel=0" 
        title="YouTube video player" 
        frameborder="0" 
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
        referrerpolicy="strict-origin-when-cross-origin" 
        allowfullscreen>
      </iframe>
    </div>
  </div>

  <div class="bottom-row">
    <div class="widget">
      <div class="news-tabs">
        <button data-type="nhk" class="active">NHK</button>
        <button data-type="doshin">é“æ–°</button>
        <button data-type="nl">åŒ—æµ·é“NL</button>
        <button data-type="tomakomai">è‹«å°ç‰§</button>
        <button data-type="gigazine">GIGAZINE</button>
        <button data-type="val4jp">VAL4JP</button>
      </div>
      <ul id="news" class="news-list"></ul>
    </div>
    <div class="widget">
      <div class="cal-nav">
        <button class="cal-btn" onclick="changeMonth(-1)">â—€</button>
        <div id="calTitle" style="font-weight:bold; font-size:14px;"></div>
        <button class="cal-btn" onclick="changeMonth(1)">â–¶</button>
      </div>
      <div class="cal-grid" id="calGrid"></div>
    </div>
  </div>
</div>

<script>
let currentViewDate = new Date();

function clock(){
  const n=new Date();
  const m=n.getMonth()+1, d=n.getDate(), w=['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'][n.getDay()];
  const h=String(n.getHours()).padStart(2,"0"), i=String(n.getMinutes()).padStart(2,"0"), s=String(n.getSeconds()).padStart(2,"0");
  document.getElementById("clock").innerHTML=`<span style="font-size:13px">${m}/${d}(${w})</span> ${h}:${i}:${s}`;
}
setInterval(clock, 1000); clock();

(async()=>{
  try{
    const r=await fetch("https://api.open-meteo.com/v1/forecast?latitude=42.58&longitude=142.13&current_weather=true");
    const d=await r.json();
    const icon={0:"â˜€ï¸",1:"ğŸŒ¤ï¸",2:"â›…",3:"â˜ï¸",45:"ğŸŒ«ï¸",61:"ğŸŒ§ï¸",71:"â„ï¸",95:"â›ˆï¸"}[d.current_weather.weathercode]||"â˜ï¸";
    document.getElementById("weather").textContent=`${icon} ${Math.round(d.current_weather.temperature)}â„ƒ`;
  }catch(e){}
})();

async function loadNews(t){
  const ul=document.getElementById("news");
  const urls={
    nhk: "https://www.nhk.or.jp/rss/news/cat0.xml",
    doshin: "https://www.hokkaido-np.co.jp/output/7/free/index.ad.xml",
    nl: "https://hokkaido-nl.jp/index.xml",
    tomakomai: "https://tomakomai.goguynet.jp/feed/",
    gigazine: "https://gigazine.net/news/rss_2.0/",
    val4jp: "https://www.valorant4jp.com/feeds/posts/default?alt=rss"
  };
  ul.innerHTML="<li>å–å¾—ä¸­...</li>";
  const proxies=[url=>`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`,url=>`https://api.allorigins.win/get?url=${encodeURIComponent(url)}` ];
  for(let getProxyUrl of proxies){
    try{
      const r=await fetch(getProxyUrl(urls[t]));
      const data=await r.json();
      let items=[];
      if(data.items){items=data.items;}
      else if(data.contents){
        const xml=new DOMParser().parseFromString(data.contents,"text/xml");
        items=Array.from(xml.querySelectorAll("item")).map(item=>({title:item.querySelector("title")?.textContent,link:item.querySelector("link")?.textContent}));
      }
      if(items&&items.length > 0){ul.innerHTML=items.slice(0,5).map(i=>`<li><a href="${i.link}" target="_blank">${i.title}</a></li>`).join('');return;}
    }catch(e){}
  }
  ul.innerHTML="<li>èª­è¾¼å¤±æ•—</li>";
}

document.querySelectorAll(".news-tabs button").forEach(b=>{b.onclick=()=>{document.querySelectorAll(".news-tabs button").forEach(x=>x.classList.remove("active"));b.classList.add("active");loadNews(b.dataset.type);};});

const HOLIDAYS_2026 = {
  "2026-01-01":"å…ƒæ—¥","2026-01-12":"æˆäººã®æ—¥","2026-02-11":"å»ºå›½è¨˜å¿µã®æ—¥","2026-02-23":"å¤©çš‡èª•ç”Ÿæ—¥",
  "2026-03-20":"æ˜¥åˆ†ã®æ—¥","2026-04-29":"æ˜­å’Œã®æ—¥","2026-05-03":"æ†²æ³•è¨˜å¿µæ—¥","2026-05-04":"ã¿ã©ã‚Šã®æ—¥",
  "2026-05-05":"ã“ã©ã‚‚ã®æ—¥","2026-05-06":"æŒ¯æ›¿ä¼‘æ—¥","2026-07-20":"æµ·ã®æ—¥","2026-08-11":"å±±ã®æ—¥",
  "2026-09-21":"æ•¬è€ã®æ—¥","2026-09-22":"å›½æ°‘ã®ä¼‘æ—¥","2026-09-23":"ç§‹åˆ†ã®æ—¥","2026-10-12":"ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥",
  "2026-11-03":"æ–‡åŒ–ã®æ—¥","2026-11-23":"å‹¤åŠ´æ„Ÿè¬ã®æ—¥"
};

function changeMonth(diff) { currentViewDate.setMonth(currentViewDate.getMonth() + diff); draw(); }

function draw(){
  const year=currentViewDate.getFullYear(), month=currentViewDate.getMonth();
  const today = new Date();
  document.getElementById("calTitle").textContent=`${year}å¹´ ${month+1}æœˆ`;
  const headers = ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'];
  let html = headers.map(h => `<div class="cal-header">${h}</div>`).join('');
  const start=new Date(year, month, 1);
  start.setDate(1 - start.getDay());
  for(let i=0; i<42; i++){
    const d=new Date(start); d.setDate(start.getDate()+i);
    const dateStr = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
    const hName = (d.getFullYear() === 2026) ? HOLIDAYS_2026[dateStr] : "";
    let colorClass = "";
    if (d.getDay() === 0 || hName) colorClass = "sun";
    else if (d.getDay() === 6) colorClass = "sat";
    const isToday = d.toDateString() === today.toDateString() ? "cal-today" : "";
    const isOtherMonth = d.getMonth() !== month ? "cal-dim" : "";
    html += `<div class="cal-cell ${isOtherMonth} ${isToday}"><div class="cal-num ${colorClass}">${d.getDate()}</div>${hName ? `<div class="holiday-name">${hName}</div>` : ""}</div>`;
  }
  document.getElementById("calGrid").innerHTML=html;
}

loadNews("nhk"); draw();
</script>
</body>
</html>