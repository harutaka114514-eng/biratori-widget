<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>biratori-widget-100win</title>
<style>
/* å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
body { font-family: sans-serif; background-color: #f0f0f0; padding: 15px; margin: 0; overflow-x: hidden; }
.widgets { display: flex; flex-direction: column; gap: 15px; max-width: 900px; margin: 0 auto; }
.widget { background: rgba(255, 255, 255, 0.9); padding: 15px; border-radius: 18px; box-shadow: 0 10px 25px rgba(0,0,0,.1); }

/* ã‚¹ãƒ­ãƒƒãƒˆã‚¹ã‚¿ã‚¤ãƒ« */
.slot-widget { text-align: center; }
.slot-reels { display: flex; justify-content: center; gap: 10px; margin: 15px 0; }
.slot-reel { 
    background: #fff; color: #000; width: 70px; height: 90px; 
    line-height: 90px; font-size: 45px; border-radius: 10px; 
    border: 4px solid #444; font-weight: bold;
}
.slot-btn { padding: 10px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; width: 100%; }
.start-btn { background: #ff4757; color: white; font-size: 18px; margin-bottom: 10px; }
.stop-btns { display: flex; gap: 8px; }
.stop-btn { background: #3498db; color: white; flex: 1; }
#slot-msg { font-size: 16px; font-weight: bold; margin-top: 10px; color: #d35400; }

/* YouTubeãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’éš ã™è¨­å®š */
#win-player-wrapper { position: absolute; left: -9999px; }
</style>
</head>
<body>

<div class="widgets">
    <div class="widget slot-widget">
        <div style="font-weight:bold;">ğŸ° ãƒ‡ãƒãƒƒã‚°ç”¨100%ã‚¹ãƒ­ãƒƒãƒˆ</div>
        <div class="slot-reels">
            <div id="reel0" class="slot-reel">?</div>
            <div id="reel1" class="slot-reel">?</div>
            <div id="reel2" class="slot-reel">?</div>
        </div>
        <button id="startBtn" class="slot-btn start-btn" onclick="startSlot()">START</button>
        <div class="stop-btns">
            <button id="stop0" class="slot-btn stop-btn" onclick="stopReel(0)" disabled>STOP</button>
            <button id="stop1" class="slot-btn stop-btn" onclick="stopReel(1)" disabled>STOP</button>
            <button id="stop2" class="slot-btn stop-btn" onclick="stopReel(2)" disabled>STOP</button>
        </div>
        <div id="slot-msg">å¿…ãšå½“ãŸã‚Šã¾ã™ï¼</div>
    </div>
</div>

<div id="win-player-wrapper">
    <div id="win-player"></div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
let winPlayer;
const symbols = ["7", "ğŸ…", "ğŸ’"];

// YouTube APIã®åˆæœŸåŒ–
function onYouTubeIframeAPIReady() {
    winPlayer = new YT.Player('win-player', {
        height: '1', width: '1',
        videoId: 'GF4bCyltSHw',
        playerVars: { 'autoplay': 1, 'mute': 1, 'enablejsapi': 1 },
        events: {
            'onReady': (event) => {
                event.target.playVideo(); // æº–å‚™å®Œäº†æ™‚ã«ä¸€æ—¦å†ç”Ÿï¼ˆã‚ªãƒ¼ãƒˆãƒ—ãƒ¬ã‚¤åˆ¶é™å¯¾ç­–ï¼‰
            }
        }
    });
}

let timers = [null, null, null], status = [false, false, false];

function startSlot() {
    // å‹•ç”»ã‚’ãƒªã‚»ãƒƒãƒˆ
    if (winPlayer) {
        winPlayer.mute();
        winPlayer.stopVideo();
    }

    document.getElementById("startBtn").disabled = true;
    document.getElementById("slot-msg").innerText = "å›è»¢ä¸­...";

    for(let i=0; i<3; i++) {
        status[i] = true;
        document.getElementById(`stop${i}`).disabled = false;
        timers[i] = setInterval(() => {
            document.getElementById(`reel${i}`).innerText = symbols[Math.floor(Math.random()*symbols.length)];
        }, 80);
    }
}

function stopReel(i) {
    if (!status[i]) return;
    clearInterval(timers[i]);
    status[i] = false;
    document.getElementById(`stop${i}`).disabled = true;

    // â˜… 100%å¿…ãšã€Œ7ã€ã«ã™ã‚‹å‡¦ç†
    document.getElementById(`reel${i}`).innerText = "7";

    if (!status.includes(true)) {
        // å¤§å½“ãŸã‚Šæ¼”å‡º
        document.getElementById("slot-msg").innerHTML = "<span style='color:red;'>ğŸ‰ å¤§å½“ãŸã‚Šç¢ºå®šï¼ï¼ ğŸ‰</span>";
        
        // YouTubeã®éŸ³ã‚’é³´ã‚‰ã™
        if (winPlayer) {
            winPlayer.unMute();
            winPlayer.setVolume(100);
            winPlayer.seekTo(0);
            winPlayer.playVideo();
        }

        // ç´™å¹é›ªã‚’é£›ã°ã™
        confetti({
            particleCount: 150,
            spread: 70,
            origin: { y: 0.6 }
        });

        document.getElementById("startBtn").disabled = false;
    }
}
</script>
</body>
</html>